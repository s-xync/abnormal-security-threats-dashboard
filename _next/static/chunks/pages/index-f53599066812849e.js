(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(2997)}])},2997:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(5893),i=s(7294),n=s(6493),r=s.n(n),l=s(9344),o=s.n(l),c=s(5697),u=s.n(c);function d(e){let{title:t,subHeading:s,titleColor:i}=e;return(0,a.jsxs)("div",{className:o().container,children:[(0,a.jsx)("p",{className:o().title,style:{color:i},children:t}),(0,a.jsx)("p",{className:o().subHeading,children:s})]})}function m(e){let{numHighSeverity:t,numSpam:s}=e;return(0,a.jsxs)("div",{className:r().container,children:[(0,a.jsx)(d,{title:String(t),subHeading:"High Severity Threats",titleColor:"red"}),(0,a.jsx)(d,{title:String(s),subHeading:"Spam Messages",titleColor:"orange"})]})}d.propTypes={title:u().string.isRequired,subHeading:u().string.isRequired,titleColor:u().string.isRequired},m.propTypes={numHighSeverity:u().number.isRequired,numSpam:u().number.isRequired};var p=s(7411),h=s.n(p);function _(e){let{topMaliciousDomains:t}=e;return(0,a.jsx)("div",{className:h().container,children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:h().title,children:"Top 5 Malicious Domains:"}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:h().tableRow,children:[(0,a.jsx)("th",{className:h().tableHeaderCell,children:"Domain"}),(0,a.jsx)("th",{className:h().tableHeaderCell,children:"% of threats"}),(0,a.jsx)("th",{className:h().tableHeaderCell,children:"# of threats"})]})}),(0,a.jsx)("tbody",{children:t.map(e=>(0,a.jsxs)("tr",{className:h().tableRow,children:[(0,a.jsx)("td",{className:h().tableDataCellDomain,children:e.domain}),(0,a.jsxs)("td",{className:h().tableDataCell,children:[e.percentage,"%"]}),(0,a.jsx)("td",{className:h().tableDataCell,children:e.threats})]},e.domain))})]})]})})}_.propTypes={topMaliciousDomains:u().arrayOf(u().shape({domain:u().string.isRequired,percentage:u().number.isRequired,threats:u().number.isRequired}).isRequired).isRequired};var f=s(5301),b=s.n(f);function x(e){let{customers:t,selectedCustomer:s,setSelectedCustomer:i}=e;return(0,a.jsxs)("div",{className:b().container,children:[(0,a.jsx)("p",{className:b().title,children:"Customer:"}),(0,a.jsx)("div",{className:b().selectOuter,children:(0,a.jsxs)("select",{className:b().select,value:s,onChange:e=>{i(e.target.value)},children:[(0,a.jsx)("option",{value:"Please select",disabled:!0,hidden:!0,children:"Please select"}),t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})})]})}x.propTypes={customers:u().arrayOf(u().shape({id:u().string.isRequired,name:u().string.isRequired}).isRequired).isRequired,selectedCustomer:u().string.isRequired,setSelectedCustomer:u().func.isRequired};var j=function(){let[e,t]=(0,i.useState)([]),[s,n]=(0,i.useState)("Please select"),[r,l]=(0,i.useState)([]),[o,c]=(0,i.useState)(0),[u,d]=(0,i.useState)(0),[p,h]=(0,i.useState)([]);(0,i.useEffect)(()=>{(async()=>{let e=await fetch("https://abnormalsecurity-public.s3.amazonaws.com/fe_dashboard/customers.json"),s=await e.json();t(s),n(s[0].id)})()},[]),(0,i.useEffect)(()=>{s&&(async()=>{let e=await fetch("https://abnormalsecurity-public.s3.amazonaws.com/fe_dashboard/".concat(s,"/messages.json")),t=await e.json();l(t)})()},[s]),(0,i.useEffect)(()=>{r.length&&(f(),b())},[r]);let f=()=>{let e=r.filter(e=>e.attackScore>.7).length,t=r.filter(e=>"SPAM"===e.attackType).length;c(e),d(t)},b=()=>{let e={},t=0;r.forEach(s=>{if(s.attackScore>.7){let a=s.from.split("@")[1];e[a]?e[a]++:e[a]=1,t++}});let s=[];for(let a in e){let i=e[a]/t*100;s.push({domain:a,percentage:Math.round(i),threats:e[a]})}s.sort((e,t)=>t.threats-e.threats);let a=s.slice(0,5);h(a)};return(0,a.jsxs)("div",{children:[(0,a.jsx)(x,{customers:e,selectedCustomer:s,setSelectedCustomer:n}),(0,a.jsx)(m,{numHighSeverity:o,numSpam:u}),(0,a.jsx)(_,{topMaliciousDomains:p})]})},g=function(){return(0,a.jsx)(j,{})}},9344:function(e){e.exports={container:"Card_container__fWV9m",title:"Card_title__oTaF_",subHeading:"Card_subHeading__BT2zV"}},5301:function(e){e.exports={container:"CustomerSelection_container__pszdM",title:"CustomerSelection_title__wEz9i",selectOuter:"CustomerSelection_selectOuter__zYk2p",select:"CustomerSelection_select__OAKGv"}},7411:function(e){e.exports={container:"MaliciousDomainsTable_container___5uL9",title:"MaliciousDomainsTable_title__5TVMB",tableRow:"MaliciousDomainsTable_tableRow__dB3KD",tableHeaderCell:"MaliciousDomainsTable_tableHeaderCell__dHviM",tableDataCellDomain:"MaliciousDomainsTable_tableDataCellDomain__KZFUY",tableDataCell:"MaliciousDomainsTable_tableDataCell__AzVY6"}},6493:function(e){e.exports={container:"TopLevelStats_container__IMTXr"}},2703:function(e,t,s){"use strict";var a=s(414);function i(){}function n(){}n.resetWarningCache=i,e.exports=function(){function e(e,t,s,i,n,r){if(r!==a){var l=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:n,resetWarningCache:i};return s.PropTypes=s,s}},5697:function(e,t,s){e.exports=s(2703)()},414:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);